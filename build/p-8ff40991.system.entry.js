var __awaiter=this&&this.__awaiter||function(e,t,r,i){function o(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function a(e){try{l(i.next(e))}catch(t){n(t)}}function s(e){try{l(i["throw"](e))}catch(t){n(t)}}function l(e){e.done?r(e.value):o(e.value).then(a,s)}l((i=i.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return l([e,t])}}function l(a){if(i)throw new TypeError("Generator is already executing.");while(r)try{if(i=1,o&&(n=a[0]&2?o["return"]:a[0]?o["throw"]||((n=o["return"])&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;if(o=0,n)a=[a[0]&2,n.value];switch(a[0]){case 0:case 1:n=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;o=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(n=r.trys,n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){r.label=a[1];break}if(a[0]===6&&r.label<n[1]){r.label=n[1];n=a;break}if(n&&r.label<n[2]){r.label=n[2];r.ops.push(a);break}if(n[2])r.ops.pop();r.trys.pop();continue}a=t.call(e,r)}catch(s){a=[6,s];o=0}finally{i=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-c883b40a.system.js","./p-2e25f10d.system.js","./p-e05ad058.system.js"],(function(e){"use strict";var t,r,i,o,n;return{setters:[function(e){t=e.r;r=e.h;i=e.H},function(e){o=e.g},function(e){n=e.h}],execute:function(){var a='textarea,input,:host{font-family:sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;-webkit-font-feature-settings:"liga";font-feature-settings:"liga"}*,*::before,*::after{-webkit-box-sizing:border-box;box-sizing:border-box}a{color:inherit;text-decoration:none}:host{display:block;max-width:500px;margin:0 auto;padding:0 5px 50px}.title{margin-top:30px;font-size:28px;font-weight:bold;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.title .label{margin:0 10px}.code-box{margin-top:50px;border:none;border-radius:5px;padding:10px;color:white;background-color:black}.code-box legend{border-radius:5px;background-color:black;font-size:18px;padding:5px 10px 0}.code-box a-input{--placeholder-color:rgba(255, 255, 255, 0.9)}a-input.passphrase{margin:30px auto 0;max-width:300px;text-align:center}a-file-input{max-width:400px;margin:30px auto 0}a-file-input.error{--label-color:red}a-button.decrypt{margin:30px auto 0;width:-webkit-min-content;width:-moz-min-content;width:min-content}a-button.decrypt.hide{display:none}a-button.decrypt:not([disabled]){-webkit-animation:0.3s spinX linear 1;animation:0.3s spinX linear 1}.files-box{margin-top:30px}.files-box .file{padding:10px;border:1px solid black;border-radius:10px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:10px}.files-box .file .name{word-break:break-word}.files-box .file .size{margin:0 5px;font-size:15px;white-space:nowrap;-ms-flex-positive:1;flex-grow:1}.files-box .file a-button{padding:5px;font-size:24px}.overlay{position:fixed;top:0;bottom:0;left:0;right:0;background:rgba(255, 255, 255, 0.95);z-index:999;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.overlay.progress ion-icon{font-size:36px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}.overlay.progress .msg{margin-top:5px;-webkit-animation:blink 1s linear infinite;animation:blink 1s linear infinite}.overlay.progress .msg::after{position:absolute;margin-left:2px;content:"..."}@-webkit-keyframes spin{0%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}20%{-webkit-transform:rotateX(-180deg) rotateY(0deg);transform:rotateX(-180deg) rotateY(0deg)}40%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}50%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}70%{-webkit-transform:rotateX(0deg) rotateY(-180deg);transform:rotateX(0deg) rotateY(-180deg)}90%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}}@keyframes spin{0%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}20%{-webkit-transform:rotateX(-180deg) rotateY(0deg);transform:rotateX(-180deg) rotateY(0deg)}40%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}50%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}70%{-webkit-transform:rotateX(0deg) rotateY(-180deg);transform:rotateX(0deg) rotateY(-180deg)}90%{-webkit-transform:rotateX(0deg) rotateY(0deg);transform:rotateX(0deg) rotateY(0deg)}}@-webkit-keyframes blink{25%{color:rgba(0, 0, 0, 0.3)}50%{color:black}}@keyframes blink{25%{color:rgba(0, 0, 0, 0.3)}50%{color:black}}@-webkit-keyframes spinX{0%{-webkit-transform:rotateX(0deg);transform:rotateX(0deg)}50%{-webkit-transform:rotateX(-90deg);transform:rotateX(-90deg)}100%{-webkit-transform:rotateX(0deg);transform:rotateX(0deg)}}@keyframes spinX{0%{-webkit-transform:rotateX(0deg);transform:rotateX(0deg)}50%{-webkit-transform:rotateX(-90deg);transform:rotateX(-90deg)}100%{-webkit-transform:rotateX(0deg);transform:rotateX(0deg)}}';var s=e("ap_decrypt_form",function(){function e(e){t(this,e);this.app=o()}e.prototype.derivePublicCode=function(){this.decryptedFiles=null;if(!this.secretCode){this.publicCode=null;return}this.publicCode=this.app.derivePublicCode(this.secretCode,this.passPhrase)};e.prototype.decryptFile=function(){return __awaiter(this,void 0,void 0,(function(){var e;var t=this;return __generator(this,(function(r){switch(r.label){case 0:if(!this.filePublicCode||this.filePublicCode!=this.publicCode){return[2]}this.overlayState={icon:"document-outline",msg:"Reading"};r.label=1;case 1:r.trys.push([1,,3,4]);e=this;return[4,Promise.all([this.app.decryptFile(this.file,this.secretCode,this.passPhrase,(function(e,r){if(e=="decrypt_begin"){t.overlayState={icon:"lock-open-outline",msg:"Decrypting"}}})),new Promise((function(e){setTimeout(e,1e3)}))])];case 2:e.decryptedFiles=r.sent()[0];return[3,4];case 3:this.overlayState=null;return[7];case 4:return[2]}}))}))};e.prototype.render=function(){var e=this;var t;var o=this.file&&!this.filePublicCode;var a=function(){if(!e.decryptedFiles){return}return e.decryptedFiles.map((function(e){return r("a-download-link",{blob:new File([e.data],e.filename),filename:e.filename},r("div",{class:"file"},r("span",{class:"name"},e.filename),r("span",{class:"size"},"(",n(e.data.byteLength),")"),r("a-button",{icon:"download-outline"})))}))};var s=function(){var t,i;if(!e.overlayState){return}return r("div",{class:"overlay progress"},r("ion-icon",{name:(t=e.overlayState)===null||t===void 0?void 0:t.icon}),r("span",{class:"msg"},(i=e.overlayState)===null||i===void 0?void 0:i.msg))};return r(i,null,r("div",{class:"title"},r("ion-icon",{name:"lock-open"}),r("span",{class:"label"},"Decryption"),r("ion-icon",{name:"lock-open"})),r("fieldset",{class:"code-box"},r("legend",null,"Secret Code"),r("a-input",{placeholder:"Paste Secret Code",type:"textarea",pattern:"^[0123456789ABCDEFGHJKMNPQRSTVWXYZ]{0,52}$",onInput:function(t){var r;var i=t.target;if(((r=i.value)===null||r===void 0?void 0:r.length)==52){e.secretCode=i.value}else{e.secretCode=null}e.derivePublicCode()}})),r("a-input",{class:"passphrase",placeholder:"Input Passphrase",type:"password",value:this.passPhrase,onInput:function(t){var r=t.target;e.passPhrase=r.value;e.derivePublicCode()}}),r("a-file-input",{class:{error:o},icon:"document-outline",label:((t=this.file)===null||t===void 0?void 0:t.name)||"Browse passfile",onSelectFile:function(t){return __awaiter(e,void 0,void 0,(function(){var e,r;return __generator(this,(function(i){switch(i.label){case 0:e=t.detail[0];if(!e){return[2]}r=this;return[4,this.app.checkHeader(e)];case 1:r.filePublicCode=i.sent();this.file=e;this.decryptedFiles=null;return[2]}}))}))}}),r("a-button",{class:{decrypt:true,hide:!this.file||!!this.decryptedFiles},label:"Decrypt",disabled:!this.filePublicCode||this.filePublicCode!=this.publicCode,onClick:function(){void e.decryptFile()}}),r("div",{class:"files-box"},a()),s())};return e}());s.style=a}}}));